<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>اللعبة المباشرة</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <style>
    body{font-family:Tajawal,system-ui,-apple-system,Segoe UI,Roboto,Arial;background:#000;color:#fff;margin:0}
    .wrap{max-width:820px;margin:56px auto;padding:20px;text-align:center}
    h1{font-size:26px;margin:0 0 18px}
    .scene{background:#0e0e0e;border:1px solid #222;border-radius:16px;padding:24px}
    #sceneTitle{font-size:22px;margin-bottom:18px;color:#ffdc73}
    .choices{display:flex;flex-direction:column;gap:14px}
    .btn{background:#141414;border:1px solid #333;border-radius:14px;padding:18px;font-size:20px;color:#fff;transition:.15s}
    .btn:active{transform:scale(.98)}
    .debug{position:fixed;left:10px;bottom:10px;background:#131313;border:1px solid #333;border-radius:10px;padding:10px;font-size:12px;color:#aaa}
    .ok{color:#7dffa3}.bad{color:#ff8b88}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>اللعبة المباشرة</h1>
    <div class="scene">
      <div id="sceneTitle">تحميل…</div>
      <div class="choices">
        <button id="choiceLeft"  class="btn">…</button>
        <button id="choiceRight" class="btn">…</button>
      </div>
    </div>
  </div>

  <div class="debug">
    Backend: <b>beamingkhaled.github.io/choices.json</b><br/>
    <span id="dbg">جارِ التحميل…</span>
  </div>

  <script>
    // ✅ Fixed JSON endpoint (GitHub Pages, not "raw")
    const JSON_URL = 'https://beamingkhaled.github.io/choices.json';

    const titleEl = document.getElementById('sceneTitle');
    const leftEl  = document.getElementById('choiceLeft');
    const rightEl = document.getElementById('choiceRight');
    const dbgEl   = document.getElementById('dbg');

    async function loadChoices(){
      try{
        const url = JSON_URL + '?ts=' + Date.now(); // hard cache-bust
        const res = await fetch(url, {cache:'no-store', headers:{'Cache-Control':'no-cache'}});
        if(!res.ok){
          dbgEl.innerHTML = '<span class="bad">HTTP ' + res.status + ' — تأكد من وجود choices.json في الجذر</span>';
          return;
        }
        const data = await res.json();

        titleEl.textContent = data.title || '';
        leftEl.textContent  = data.left  || '';
        rightEl.textContent = data.right || '';

        dbgEl.innerHTML = '<span class="ok">OK</span> ' + new Date().toLocaleTimeString();
      }catch(e){
        dbgEl.innerHTML = '<span class="bad">خطأ: ' + (e && e.message ? e.message : e) + '</span>';
      }
    }

    loadChoices();
    setInterval(loadChoices, 2000);
  </script>
</body>
</html>
