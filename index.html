<!DOCTYPE html>

<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø£ÙÙŠÙ†ÙˆØ² ÙˆØ§Ù„ØªÙ†Ø§Ù†ÙŠÙ† - Avenues & Dragons</title>
    <style>
        /* ---------- Base & Background ---------- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html, body { height: 100%; }
        body {
            font-family: "Tajawal", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
            background: #000; 
            color: #fff; 
            overflow-x: hidden;
        }

```
    /* Fullscreen looping video background */
    #bg-video {
        position: fixed; 
        inset: 0;
        width: 100%; 
        height: 100%;
        object-fit: cover; 
        z-index: -3;
        filter: brightness(58%);
    }

    /* Optional extra subtle vignette */
    .vignette {
        position: fixed; 
        inset: 0; 
        z-index: -2;
        pointer-events: none;
        background: radial-gradient(120% 120% at 50% 50%,
            rgba(0,0,0,0) 40%, rgba(0,0,0,0.25) 100%);
    }

    /* ---------- Card ---------- */
    .game-wrap {
        min-height: 100vh; 
        width: 100%;
        display: grid; 
        place-items: center; 
        padding: 24px;
    }
    
    .card {
        width: min(92vw, 720px);
        background: rgba(10, 10, 16, 0.55);
        -webkit-backdrop-filter: blur(10px);
        backdrop-filter: blur(10px);
        border-radius: 22px;
        border: 1px solid rgba(255,255,255,0.07);
        box-shadow:
            0 10px 40px rgba(0,0,0,0.45),
            inset 0 0 0 1px rgba(255,255,255,0.03);
        padding: 26px 22px 32px;
    }

    /* ---------- Title & Question ---------- */
    .title {
        font-weight: 800; 
        letter-spacing: .5px;
        font-size: clamp(22px, 5.2vw, 38px);
        text-align: center; 
        margin-bottom: 10px;
        background: linear-gradient(135deg, #7D5EFF, #9A68FF);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    
    .question {
        text-align: center;
        color: #d9d9e6;
        font-size: clamp(16px, 4.2vw, 22px);
        margin: 4px auto 18px;
        min-height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .question.updating {
        animation: pulse 0.5s ease;
    }

    @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
    }

    /* ---------- Choices (4) with Neon ---------- */
    .choices {
        display: grid; 
        gap: 16px;
    }

    /* Each choice gets a sticker via data attribute */
    .choice {
        position: relative;
    }

    .choice::before {
        content: attr(data-sticker);
        position: absolute;
        top: -10px; 
        left: 10px;
        padding: 8px 14px;
        background: rgba(255,255,255,0.16);
        color: #fff;
        border-radius: 12px;
        backdrop-filter: blur(6px);
        -webkit-backdrop-filter: blur(6px);
        font-weight: 800;
        font-size: 14px;
        line-height: 1;
        border: 1px solid rgba(255,255,255,0.25);
        box-shadow: 0 4px 14px rgba(0,0,0,0.35);
        z-index: 1;
    }

    .btn {
        width: 100%;
        border: 0; 
        outline: 0;
        border-radius: 18px;
        padding: 18px 20px;
        text-align: center;
        font-weight: 700;
        font-size: clamp(16px, 4.4vw, 22px);
        color: #e9e7ff;
        cursor: default;
        background: linear-gradient(180deg, #0d0d15, #12121c);
        box-shadow:
            0 0 0 1px rgba(125, 94, 255, 0.25) inset,
            0 0 14px rgba(125, 94, 255, 0.45),
            0 0 50px rgba(125, 94, 255, 0.28);
        position: relative;
        transition: all 0.3s ease;
    }
    
    .btn::after {
        content: "";
        position: absolute; 
        inset: 0;
        border-radius: 18px;
        padding: 1px;
        background: linear-gradient(90deg, #7D5EFF, #9A68FF, #7D5EFF);
        -webkit-mask: 
            linear-gradient(#000 0 0) content-box, 
            linear-gradient(#000 0 0);
        -webkit-mask-composite: xor; 
        mask-composite: exclude;
        opacity: .9;
    }

    .btn.updating {
        animation: pulse 0.5s ease;
    }

    /* Status text at bottom */
    .status {
        text-align: center; 
        margin-top: 16px;
        color: #bdb8ff; 
        font-size: 14px; 
        opacity: .85;
        padding: 8px;
        border-radius: 8px;
    }

    .status.connected {
        color: #10b981;
    }

    .status.updating {
        color: #f59e0b;
        font-weight: 600;
    }

    .status.error {
        color: #ef4444;
    }

    /* Setup prompt */
    .setup-prompt {
        background: rgba(255, 243, 205, 0.95);
        border: 2px solid #ffc107;
        border-radius: 16px;
        padding: 25px;
        margin-bottom: 20px;
        text-align: center;
        backdrop-filter: blur(10px);
    }

    .setup-prompt h3 {
        color: #856404;
        margin-bottom: 15px;
        font-size: 20px;
    }

    .setup-prompt p {
        color: #856404;
        margin-bottom: 12px;
    }

    .setup-prompt label {
        display: block;
        color: #856404;
        font-weight: 600;
        margin-top: 15px;
        margin-bottom: 5px;
        text-align: right;
    }

    .setup-prompt input {
        width: 100%;
        max-width: 500px;
        padding: 12px;
        margin: 5px 0;
        border: 2px solid #ffc107;
        border-radius: 8px;
        font-size: 1em;
        font-family: monospace;
        background: rgba(255,255,255,0.9);
    }

    .setup-prompt button {
        padding: 15px 40px;
        background: #28a745;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1.2em;
        font-weight: 600;
        cursor: pointer;
        margin-top: 15px;
    }

    .setup-prompt button:hover {
        background: #218838;
    }

    .reset-link {
        margin-top: 15px;
        color: #856404;
        font-size: 0.9em;
        cursor: pointer;
        text-decoration: underline;
    }

    /* ---------- Responsive ---------- */
    @media (max-width: 480px) {
        .choice::before { 
            top: -12px; 
            left: 8px; 
            font-size: 13px; 
        }
        .btn { 
            padding: 16px 16px; 
            border-radius: 16px; 
        }
        .btn::after { 
            border-radius: 16px; 
        }
    }
</style>
```

</head>
<body>

<!-- Background video (Cloudinary, looped) -->

<video id="bg-video" autoplay muted loop playsinline>
    <source src="https://res.cloudinary.com/dkaldddme/video/upload/f_auto,q_auto/v1/copy_A02E4E6D-2A21-48D1-B12F-3B3343D20C85_bp4lka.mp4" type="video/mp4" />
</video>
<div class="vignette" aria-hidden="true"></div>

<div class="game-wrap">
    <div class="card">
        <div class="title">Avenues & Dragons</div>

```
    <div class="setup-prompt" id="setupPrompt" style="display: none;">
        <h3>âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Ù„Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©</h3>
        <p>Ø§Ø³ØªØ®Ø¯Ù… Ù†ÙØ³ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</p>
        
        <label>Bin ID:</label>
        <input type="text" id="binIdInput" placeholder="Ø§Ù„ØµÙ‚ Bin ID Ù‡Ù†Ø§">
        
        <label>API Key (Master Key):</label>
        <input type="text" id="apiKeyInput" placeholder="Ø§Ù„ØµÙ‚ Master Key Ù‡Ù†Ø§">
        
        <button onclick="saveBinIdViewer()">âœ… Ø­ÙØ¸ ÙˆØ§Ù„Ø¨Ø¯Ø¡</button>
        
        <div class="reset-link" onclick="resetViewer()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</div>
    </div>

    <div id="question" class="question">Ø§Ù†ØªØ¸Ø± Ø§Ù„Ø³Ø¤Ø§Ù„ Ù…Ù† Ø§Ù„Ù…Ù‚Ø¯Ù…...</div>

    <div class="choices">
        <div class="choice" data-sticker="Ø§ÙƒØªØ¨ÙˆØ§ Ù¡">
            <div id="choice1" class="btn">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„</div>
        </div>
        <div class="choice" data-sticker="Ø§ÙƒØªØ¨ÙˆØ§ Ù¢">
            <div id="choice2" class="btn">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</div>
        </div>
        <div class="choice" data-sticker="Ø§ÙƒØªØ¨ÙˆØ§ Ù£">
            <div id="choice3" class="btn">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù„Ø«</div>
        </div>
        <div class="choice" data-sticker="Ø§ÙƒØªØ¨ÙˆØ§ Ù¤">
            <div id="choice4" class="btn">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø±Ø§Ø¨Ø¹</div>
        </div>
    </div>

    <div id="status" class="status connected">ğŸŸ¢ Ø¬Ø§Ù‡Ø² - ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª</div>
</div>
```

</div>

<script>
    let lastTimestamp = 0;
    let checkInterval;
    let BIN_ID = localStorage.getItem('q8_bin_id');
    let API_KEY = localStorage.getItem('q8_api_key');
    
    function saveBinIdViewer() {
        const binId = document.getElementById('binIdInput').value.trim();
        const apiKey = document.getElementById('apiKeyInput').value.trim();
        
        if (!binId || !apiKey) {
            alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Bin ID Ùˆ API Key');
            return;
        }
        
        localStorage.setItem('q8_bin_id', binId);
        localStorage.setItem('q8_api_key', apiKey);
        BIN_ID = binId;
        API_KEY = apiKey;
        document.getElementById('setupPrompt').style.display = 'none';
        startChecking();
        loadInitialData();
    }

    function resetViewer() {
        if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªØŸ')) {
            localStorage.removeItem('q8_bin_id');
            localStorage.removeItem('q8_api_key');
            location.reload();
        }
    }

    if (!BIN_ID || !API_KEY) {
        document.getElementById('setupPrompt').style.display = 'block';
    }

    function showUpdateAnimation() {
        const statusEl = document.getElementById('status');
        const questionEl = document.getElementById('question');
        
        statusEl.textContent = 'âš¡ ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ù„Ù„ØªÙˆ!';
        statusEl.className = 'status updating';
        
        questionEl.classList.add('updating');
        document.querySelectorAll('.btn').forEach(btn => {
            btn.classList.add('updating');
        });
        
        setTimeout(() => {
            questionEl.classList.remove('updating');
            document.querySelectorAll('.btn').forEach(btn => {
                btn.classList.remove('updating');
            });
            
            statusEl.textContent = 'ğŸŸ¢ Ù…ØªØµÙ„ ÙˆÙ…Ø­Ø¯Ø«';
            statusEl.className = 'status connected';
        }, 2000);
    }

    function updateGameDisplay(data) {
        if (data.question) {
            document.getElementById('question').textContent = data.question;
        }
        
        if (data.choices) {
            document.getElementById('choice1').textContent = data.choices[0] || 'Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„';
            document.getElementById('choice2').textContent = data.choices[1] || 'Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ';
            document.getElementById('choice3').textContent = data.choices[2] || 'Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù„Ø«';
            document.getElementById('choice4').textContent = data.choices[3] || 'Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø±Ø§Ø¨Ø¹';
        }
        
        if (data.title) {
            document.querySelector('.title').textContent = data.title;
        }
    }
    
    async function checkForUpdates() {
        if (!BIN_ID || !API_KEY) return;
        
        try {
            const response = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
                method: 'GET',
                headers: {
                    'X-Master-Key': API_KEY
                }
            });
            
            if (response.ok) {
                const result = await response.json();
                const data = result.record;
                
                if (data.timestamp && data.timestamp > lastTimestamp) {
                    lastTimestamp = data.timestamp;
                    console.log('New update received:', data);
                    showUpdateAnimation();
                    updateGameDisplay(data);
                }
            } else {
                console.log('Fetch failed:', response.status);
            }
        } catch(err) {
            console.log('Check error:', err);
        }
    }
    
    async function loadInitialData() {
        if (!BIN_ID || !API_KEY) return;
        
        document.getElementById('status').textContent = 'ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...';
        document.getElementById('status').className = 'status';
        
        try {
            const response = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
                method: 'GET',
                headers: {
                    'X-Master-Key': API_KEY
                }
            });
            
            if (response.ok) {
                const result = await response.json();
                const data = result.record;
                
                if (data.timestamp) {
                    lastTimestamp = data.timestamp;
                    updateGameDisplay(data);
                    console.log('Loaded initial data:', data);
                    document.getElementById('status').textContent = 'ğŸŸ¢ Ù…ØªØµÙ„ ÙˆÙ…Ø­Ø¯Ø«';
                    document.getElementById('status').className = 'status connected';
                }
            } else {
                document.getElementById('status').textContent = 'âš ï¸ ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Bin ID Ùˆ API Key';
                document.getElementById('status').className = 'status error';
            }
        } catch(err) {
            console.log('Initial load error:', err);
            document.getElementById('status').textContent = 'âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„';
            document.getElementById('status').className = 'status error';
        }
    }
    
    function startChecking() {
        if (checkInterval) clearInterval(checkInterval);
        checkInterval = setInterval(checkForUpdates, 1000);
    }

    if (BIN_ID && API_KEY) {
        loadInitialData();
        startChecking();
    }
    
    window.addEventListener('beforeunload', () => {
        if (checkInterval) {
            clearInterval(checkInterval);
        }
    });
</script>

</body>
</html>
