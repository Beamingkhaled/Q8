<!-- inside <head> -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

<!-- at the end of <body> -->
<script>
  // CHANGE this URL to your backend site:
  const BACKEND_URL = 'https://YOUR-BACKEND-SITE.github.io/';

  let lastPayloadHash = '';

  async function fetchLiveChoices() {
    try {
      const res = await fetch(BACKEND_URL, {
        cache: 'no-store',
        headers: { 'Pragma': 'no-cache', 'Cache-Control': 'no-cache' }
      });
      const html = await res.text();
      const start = html.indexOf('<!-- LIVE_CHOICES_START -->');
      const end   = html.indexOf('<!-- LIVE_CHOICES_END -->');
      const inner = html.slice(start, end);
      const preStart = inner.indexOf('>') + 1;
      const preEnd   = inner.lastIndexOf('</pre>');
      const jsonText = inner.slice(preStart, preEnd).trim();
      const data = JSON.parse(jsonText);

      const h = JSON.stringify(data);
      if (h !== lastPayloadHash) {
        applyChoicesToUI(data);
        lastPayloadHash = h;
      }
    } catch (err) {
      console.error(err);
    }
  }

  function applyChoicesToUI(data){
    const titleEl = document.getElementById('sceneTitle');
    const leftEl  = document.getElementById('choiceLeft');
    const rightEl = document.getElementById('choiceRight');

    if (titleEl) titleEl.textContent = data.title || '';
    if (leftEl)  leftEl.textContent  = data.left  || '';
    if (rightEl) rightEl.textContent = data.right || '';
  }

  fetchLiveChoices();
  setInterval(fetchLiveChoices, 2000);
</script>
