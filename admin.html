<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙÙˆØ±ÙŠØ© | JSONBin</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;800&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#000;--card:#111;--border:#222;--text:#fff;--ok:#28c76f;--muted:#9aa0a6;--radius:16px}
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font-family:'Tajawal',system-ui,Segoe UI,Roboto,Arial,sans-serif}
    .wrap{width:min(900px,94vw);margin:24px auto;padding:8px 10px 40px}
    h1{font-size:26px;margin:10px 0 18px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:16px 14px;margin:14px 0;box-shadow:0 12px 30px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.04)}
    label{display:block;font-weight:800;margin:6px 2px 8px}
    input{width:100%;background:#0b0b0b;border:1px solid #1f1f1f;border-radius:12px;color:#fff;padding:14px 12px;font-size:16px;outline:none}
    .row{display:grid;grid-template-columns:1fr;gap:10px}
    @media(min-width:720px){.row{grid-template-columns:1fr 1fr}}
    button{background:#191919;border:1px solid #2b2b2b;border-radius:14px;color:#fff;padding:14px 16px;font-size:16px;font-weight:800;cursor:pointer;width:100%}
    button.primary{background:#1a3a22;border-color:#285d3a}
    .ok{color:var(--ok);font-weight:800}
    pre{white-space:pre-wrap;word-break:break-word;max-height:50vh;overflow:auto;background:#0b0b0b;border:1px solid #1f1f1f;border-radius:12px;padding:12px}
    .muted{color:var(--muted);font-size:13px}
    .inline{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    a{color:#9ad3ff;text-decoration:none}
    .link{background:#0b0b0b;border:1px dashed #2b2b2b;border-radius:10px;padding:10px;font-size:13px;overflow:auto}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… ÙÙˆØ±ÙŠØ© â€” JSONBin (Ø¨Ø¯ÙˆÙ† ØªØ£Ø®ÙŠØ±)</h1>

    <div class="card">
      <label>ğŸ”‘ JSONBin API Key (Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©)</label>
      <input id="apiKey" type="password" placeholder="Ø§Ø¨Ø¯Ø£ Ù…Ù† jsonbin.io > API Keys" />
      <div class="row" style="margin-top:10px">
        <div>
          <label>ğŸ†” Bin ID</label>
          <input id="binId" placeholder="ÙØ§Ø±Øº Ø¥Ø°Ø§ Ø³ØªÙ†Ø´Ø¦ Bin Ø¬Ø¯ÙŠØ¯" />
        </div>
        <div>
          <label>ğŸŒ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©</label>
          <div id="viewerLink" class="link">â€”</div>
        </div>
      </div>
      <div class="row" style="margin-top:10px">
        <button id="createBin">âœ¨ Ø¥Ù†Ø´Ø§Ø¡ Bin Ø¹Ø§Ù… Ù„Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ÙÙˆØ±ÙŠØ©</button>
        <button id="saveCreds">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
      </div>
      <div class="muted">- Ø¥Ù†Ø´Ø§Ø¡ Bin ÙŠØ¬Ø¹Ù„ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø¹Ø§Ù…Ø© (Public) Ù„ØªØ¹Ù…Ù„ Ù„Ù„Ø¹Ø±Ø¶ Ø¨Ø¯ÙˆÙ† Ù…ÙØ§ØªÙŠØ­. Ø§Ù„ÙƒØªØ§Ø¨Ø© Ù…Ø­Ù…ÙŠØ© Ø¨Ø§Ù„Ù…ÙØªØ§Ø­ ÙÙ‚Ø· Ù„Ø¯ÙŠÙƒ.</div>
    </div>

    <div class="card">
      <div class="row">
        <div>
          <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø´Ù‡Ø¯</label>
          <input id="title" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ù‚Ø±Ø§Ø± ÙÙŠ Ø§Ù„Ù…ÙˆÙ„" />
        </div>
      </div>
      <div class="row">
        <div>
          <label>Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙŠØ³Ø±</label>
          <input id="left" placeholder="Ù†Ø¯Ø®Ù„ Ø§Ù„Ù‚Ù‡ÙˆØ©ØŸ" />
        </div>
        <div>
          <label>Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙŠÙ…Ù†</label>
          <input id="right" placeholder="Ù†ØªÙ…Ø´Ù‰ Ø£ÙˆÙ„ØŸ" />
        </div>
      </div>
      <div class="row" style="margin-top:10px">
        <button class="primary" id="saveBtn">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¢Ù† (ÙÙˆØ±ÙŠ)</button>
        <button id="loadBtn">âŸ³ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ</button>
      </div>
      <div id="status" style="margin-top:10px"></div>
    </div>

    <div class="card">
      <label>Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ (ØªØ£ÙƒÙŠØ¯)</label>
      <pre id="preview">â€”</pre>
      <div class="muted">Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø³ÙŠØ¸Ù‡Ø± ÙÙˆÙ‚. Ø§Ø³ØªØ®Ø¯Ù…Ù‡ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø«Ø› ÙŠØ­Ø¯Ø« ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ ÙƒÙ„ Ø«Ø§Ù†ÙŠØ© Ø¨Ø¯ÙˆÙ† ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©.</div>
    </div>
  </div>

<script>
  const $ = id => document.getElementById(id);
  const apiKeyInput = $('apiKey');
  const binIdInput  = $('binId');
  const titleInput  = $('title');
  const leftInput   = $('left');
  const rightInput  = $('right');
  const statusEl    = $('status');
  const previewEl   = $('preview');
  const viewerLinkEl= $('viewerLink');

  // restore saved
  apiKeyInput.value = localStorage.getItem('jsonbin_api_key') || '';
  binIdInput.value  = localStorage.getItem('jsonbin_id') || '';

  function saveCreds(){
    localStorage.setItem('jsonbin_api_key', apiKeyInput.value.trim());
    localStorage.setItem('jsonbin_id', binIdInput.value.trim());
    updateViewerLink();
  }

  function updateViewerLink(){
    const id = binIdInput.value.trim();
    if(!id){ viewerLinkEl.textContent = 'â€”'; return; }
    const url = `https://beamingkhaled.github.io/Q8/?bin=${encodeURIComponent(id)}`;
    viewerLinkEl.innerHTML = `<a href="${url}" target="_blank">${url}</a>`;
  }
  updateViewerLink();

  async function createBin(){
    try{
      statusEl.textContent = 'â³ Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Bin...';
      const body = { title: "", left: "", right: "", updatedAt: "" };
      const res = await fetch('https://api.jsonbin.io/v3/b', {
        method:'POST',
        headers:{
          'Content-Type':'application/json',
          'X-Master-Key': apiKeyInput.value.trim(),
          // make it readable publicly so viewer needs no key:
          'X-Bin-Private':'false'
        },
        body: JSON.stringify(body)
      });
      if(!res.ok) throw new Error('Create '+res.status+' '+await res.text());
      const data = await res.json();
      // v3 returns metadata.id
      const id = (data && data.metadata && data.metadata.id) ? data.metadata.id : (data.id || '').replace('/b/','').replace('/latest','');
      if(!id) throw new Error('Ù„Ù… Ø£Ø³ØªØ·Ø¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Bin ID');
      binIdInput.value = id;
      saveCreds();
      statusEl.innerHTML = 'âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Bin â€” ØªÙ… ØªÙˆÙ„ÙŠØ¯ Bin ID';
      previewEl.textContent = JSON.stringify(body, null, 2);
    }catch(e){
      statusEl.innerHTML = 'âŒ ÙØ´Ù„ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: '+String(e.message).replace(/</g,'&lt;');
    }
  }

  async function loadCurrent(){
    try{
      statusEl.textContent = 'â³ Ù‚Ø±Ø§Ø¡Ø©...';
      const id = binIdInput.value.trim();
      if(!id) throw new Error('Ø£Ø¯Ø®Ù„ Bin ID Ø£Ùˆ Ø£Ù†Ø´Ø¦ ÙˆØ§Ø­Ø¯Ø§Ù‹');
      const res = await fetch(`https://api.jsonbin.io/v3/b/${id}/latest?t=${Date.now()}`, { cache:'no-store' });
      if(!res.ok) throw new Error('GET '+res.status+' '+await res.text());
      const data = await res.json();
      const record = data && data.record ? data.record : data;
      previewEl.textContent = JSON.stringify(record, null, 2);
      statusEl.textContent = '';
    }catch(e){
      statusEl.innerHTML = 'âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: '+String(e.message).replace(/</g,'&lt;');
    }
  }

  async function saveNow(){
    try{
      statusEl.textContent = 'â³ Ø­ÙØ¸...';
      const id    = binIdInput.value.trim();
      const key   = apiKeyInput.value.trim();
      if(!id) throw new Error('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Bin ID');
      if(!key) throw new Error('Ø£Ø¯Ø®Ù„ API Key');

      const payload = {
        title: titleInput.value.trim(),
        left:  leftInput.value.trim(),
        right: rightInput.value.trim(),
        updatedAt: new Date().toISOString()
      };

      const res = await fetch(`https://api.jsonbin.io/v3/b/${id}`, {
        method:'PUT',
        headers:{
          'Content-Type':'application/json',
          'X-Master-Key': key
        },
        body: JSON.stringify(payload)
      });
      if(!res.ok) throw new Error('PUT '+res.status+' '+await res.text());
      statusEl.innerHTML = 'âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸ â€” ÙŠØ¸Ù‡Ø± ÙÙˆØ±Ù‹Ø§ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø¹Ø±Ø¶';
      previewEl.textContent = JSON.stringify(payload, null, 2);
    }catch(e){
      statusEl.innerHTML = 'âŒ ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸: '+String(e.message).replace(/</g,'&lt;');
    }
  }

  $('createBin').addEventListener('click', createBin);
  $('saveCreds').addEventListener('click', saveCreds);
  $('saveBtn').addEventListener('click', saveNow);
  $('loadBtn').addEventListener('click', loadCurrent);
</script>
</body>
</html>
