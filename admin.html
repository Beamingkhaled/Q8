$('save').onclick=async()=>{
  // NOTE: We are forcing the POST (Create New) method to break the loop.

  const dataObj = {
    title:$('title').value.trim()||'Avenues & Dragons',
    question:$('question').value.trim()||'…',
    choice1:$('choice1').value.trim()||'…',
    choice2:$('choice2').value.trim()||'…',
    bg:$('bg').value.trim()||''
  };
  
  // This is your specific Collection URL for creating new records
  const COLLECTION_URL = "https://api.myjson.online/v1/collections/9fb63b72-4017-4756-bd7b-2aeb49c9c574/records"; 

  try{
    // 1. CREATE NEW DATA (POST)
    const r=await fetch(COLLECTION_URL,{
      method:'POST', // FORCED POST
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify(dataObj)
    });
    
    if(!r.ok) throw new Error(await r.text()||('HTTP '+r.status));
    
    const newJson = await r.json();
    const newUrl = newJson.url; // Get the URL of the newly created record

    // Update the Admin Page with the new URL and save it to browser storage
    $('url').value = newUrl;
    localStorage.setItem('myjson_data_url', newUrl); 

    // 2. SEND PUSHER TRIGGER (Visits the Webhook URL)
    await fetch(PUSHER_TRIGGER_URL, {method:'GET'}); 

    setStatus(`تم إنشاء سجل جديد وإرسال إشارة التحديث ✅`,true);

  }catch(e){ setStatus('فشل الحفظ ❌ — '+(e.message||e),false);}
};
